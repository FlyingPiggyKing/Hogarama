// See: https://github.com/jenkinsci/kubernetes-plugin

podTemplate(label: 'hogarama-jenkins-slave-maven', cloud: 'openshift', containers: [
    containerTemplate(name: 'hogarama-jenkins-slave-maven', image: 'hogarama-jenkins-slave-maven', ttyEnabled: true, command: 'cat',
                      workingDir: '/home/jenkins',
                      alwaysPullImage: true,
                      resourceRequestCpu: '1000m',
                      resourceLimitCpu: '2000m',
                      resourceRequestMemory: '512Mi',
                      resourceLimitMemory: '1024Mi',
                      slaveConnectTimeout: 180,
                      envVars: [envVar(key: 'MAVEN_MIRROR_URL', value: "${MAVEN_MIRROR_URL}")])
  ]) {
    node('hogarama-jenkins-slave-maven') {
        stage('Build') {
          git url: "${GIT_REPO}", branch: "${GIT_REF}"
          container('hhogarama-jenkins-slave-maven') {
            sh "mvn -s Hogajama/build/settings.xml clean test -f Hogajama/pom.xml"
          }
       }
   }
}
